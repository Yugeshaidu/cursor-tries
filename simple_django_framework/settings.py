"""
Django settings for simple_django_framework project.

This file is the CONTROL CENTER of your Django project! ğŸ›ï¸
Think of it as the dashboard of a car - it controls how everything works.

Generated by 'django-admin startproject' using Django 5.2.4.

For more information on this file, see:
https://docs.djangoproject.com/en/5.2/topics/settings/

For the full list of settings and their values, see:
https://docs.djangoproject.com/en/5.2/ref/settings/
"""

# Import the Path class to handle file system paths in a cross-platform way
# This works on Windows, Mac, and Linux! ğŸŒ
from pathlib import Path
import os  # Import os for operating system interface functions

# Build paths inside the project like this: BASE_DIR / 'subdir'.
# BASE_DIR is the ROOT folder of your Django project ğŸ“
# It's like the "home address" of your project
BASE_DIR = Path(__file__).resolve().parent.parent

# Create a logs directory if it doesn't exist ğŸ“
# This is where we'll store all our error messages and activity logs
LOGS_DIR = BASE_DIR / 'logs'
LOGS_DIR.mkdir(exist_ok=True)  # Create the directory if it doesn't exist

# Quick-start development settings - unsuitable for production
# See https://docs.djangoproject.com/en/5.2/howto/deployment/checklist/

# SECURITY WARNING: keep the secret key used in production secret! ğŸ”
# This is like a password for your Django project - keep it safe!
# In production, this should be stored in environment variables, not in code
SECRET_KEY = 'django-insecure-gn$^7@d!gg&^mguiw5!ai4m(&+ruq1wy=jgfgi)-d_r&ia+&7p'

# SECURITY WARNING: don't run with debug turned on in production! âš ï¸
# DEBUG=True shows detailed error pages - helpful for development
# but dangerous in production because it reveals sensitive information
DEBUG = True

# List of host/domain names that this Django site can serve ğŸŒ
# Empty list means only localhost (127.0.0.1) is allowed
# In production, add your domain name here like ['mydomain.com']
ALLOWED_HOSTS = []

# Application definition ğŸ“±
# This list tells Django which "apps" (features) are part of your project

INSTALLED_APPS = [
    # Built-in Django apps (these come free with Django!) ğŸ
    'django.contrib.admin',        # Admin panel - like a control room for your data
    'django.contrib.auth',         # User authentication - login/logout system
    'django.contrib.contenttypes', # Content type framework - tracks your models
    'django.contrib.sessions',     # Session framework - remembers user data
    'django.contrib.messages',     # Messaging framework - for notifications
    'django.contrib.staticfiles',  # Static files management - CSS, JS, images
    
    # Your custom apps go here! ğŸ—ï¸
    'main_app',  # This is the app we created - add it so Django knows about it
]

# Middleware stack ğŸ¥ª
# Think of middleware as layers in a sandwich - each request passes through them
# They process requests BEFORE they reach your views, and responses AFTER

MIDDLEWARE = [
    # Security middleware - adds security headers to responses ğŸ›¡ï¸
    'django.middleware.security.SecurityMiddleware',
    
    # Session middleware - handles user sessions (login status, etc.) ğŸ‘¤
    'django.contrib.sessions.middleware.SessionMiddleware',
    
    # Common middleware - handles URL rewriting and other common tasks ğŸ”§
    'django.middleware.common.CommonMiddleware',
    
    # CSRF protection - prevents Cross-Site Request Forgery attacks ğŸ›¡ï¸
    'django.middleware.csrf.CsrfViewMiddleware',
    
    # Authentication middleware - associates users with requests ğŸ”
    'django.contrib.auth.middleware.AuthenticationMiddleware',
    
    # Messages middleware - enables the messaging framework ğŸ’¬
    'django.contrib.messages.middleware.MessageMiddleware',
    
    # Clickjacking protection - prevents your site from being embedded in frames ğŸ›¡ï¸
    'django.middleware.clickjacking.XFrameOptionsMiddleware',
]

# Root URL configuration ğŸ—ºï¸
# This tells Django where to find your main URL routing file
# It's like the main directory of your website
ROOT_URLCONF = 'simple_django_framework.urls'

# Template engine configuration ğŸ¨
# Templates are HTML files with special Django tags for dynamic content

TEMPLATES = [
    {
        # Use Django's built-in template engine ğŸ­
        'BACKEND': 'django.template.backends.django.DjangoTemplates',
        
        # Directories to search for templates ğŸ“
        # Empty means it will look in each app's 'templates' folder
        'DIRS': [],
        
        # Look for templates in each app's directory? Yes! âœ…
        'APP_DIRS': True,
        
        # Additional options for the template engine âš™ï¸
        'OPTIONS': {
            # Context processors add variables to ALL templates automatically ğŸ
            'context_processors': [
                # Makes 'request' object available in templates ğŸ“
                'django.template.context_processors.request',
                # Makes user authentication info available ğŸ‘¤
                'django.contrib.auth.context_processors.auth',
                # Makes messages available in templates ğŸ’¬
                'django.contrib.messages.context_processors.messages',
            ],
        },
    },
]

# WSGI application - how your Django app talks to web servers ğŸŒ
# WSGI = Web Server Gateway Interface
WSGI_APPLICATION = 'simple_django_framework.wsgi.application'

# Database configuration ğŸ—„ï¸
# This tells Django how to connect to your database
# SQLite is perfect for development - it's just a file!

DATABASES = {
    # The default database connection ğŸ”Œ
    'default': {
        # SQLite engine - simple file-based database, perfect for learning! ğŸ“
        'ENGINE': 'django.db.backends.sqlite3',
        # Database file location - it will be created in your project root ğŸ“
        'NAME': BASE_DIR / 'db.sqlite3',
    }
    # You can add more databases here if needed:
    # 'users_db': { ... },
    # 'analytics_db': { ... },
}

# Password validation rules ğŸ”’
# These rules make sure users create strong passwords

AUTH_PASSWORD_VALIDATORS = [
    {
        # Don't allow passwords too similar to user information ğŸ‘¤
        'NAME': 'django.contrib.auth.password_validation.UserAttributeSimilarityValidator',
    },
    {
        # Require minimum password length (default: 8 characters) ğŸ“
        'NAME': 'django.contrib.auth.password_validation.MinimumLengthValidator',
    },
    {
        # Don't allow common passwords like "password123" ğŸš«
        'NAME': 'django.contrib.auth.password_validation.CommonPasswordValidator',
    },
    {
        # Don't allow passwords that are entirely numeric ğŸ”¢
        'NAME': 'django.contrib.auth.password_validation.NumericPasswordValidator',
    },
]

# Internationalization settings ğŸŒ
# These settings control language and localization

# Default language for your site ğŸ—£ï¸
LANGUAGE_CODE = 'en-us'

# Default timezone for your site ğŸ•
# UTC is recommended for international applications
TIME_ZONE = 'UTC'

# Enable Django's translation system? Yes! ğŸŒ
# This allows you to translate your site into multiple languages
USE_I18N = True

# Use timezone-aware datetime objects? Yes! â°
# This ensures proper handling of different timezones
USE_TZ = True

# Static files configuration (CSS, JavaScript, Images) ğŸ¨
# URL prefix for static files - appears in URLs like /static/css/style.css
STATIC_URL = 'static/'

# Directory where collected static files will be stored ğŸ“
# Used when you run 'python manage.py collectstatic'
STATIC_ROOT = BASE_DIR / 'staticfiles'

# Additional directories to search for static files ğŸ”
STATICFILES_DIRS = [
    BASE_DIR / 'static',  # Look for static files in project root 'static' folder
]

# Media files configuration (user-uploaded files) ğŸ“¸
# URL prefix for media files - appears in URLs like /media/uploads/photo.jpg
MEDIA_URL = 'media/'

# Directory where uploaded files will be stored ğŸ“
MEDIA_ROOT = BASE_DIR / 'media'

# Default primary key field type ğŸ”‘
# This sets the default type for auto-generated ID fields
DEFAULT_AUTO_FIELD = 'django.db.models.BigAutoField'

# LOGGING CONFIGURATION ğŸ“
# This is the complete logging setup for tracking errors and activity!

LOGGING = {
    # Version of logging configuration schema (always 1) ğŸ”¢
    'version': 1,
    
    # Don't disable existing loggers âœ…
    'disable_existing_loggers': False,
    
    # Formatters define how log messages look ğŸ¨
    'formatters': {
        # Verbose format - includes lots of details ğŸ“‹
        'verbose': {
            'format': '{levelname} {asctime} {module} {process:d} {thread:d} {message}',
            'style': '{',  # Use new-style string formatting
        },
        # Simple format - just level, time, and message ğŸ¯
        'simple': {
            'format': '{levelname} {asctime} {message}',
            'style': '{',
        },
    },
    
    # Handlers determine WHERE log messages go ğŸ“
    'handlers': {
        # Send ERROR and CRITICAL messages to a file ğŸ“
        'file_error': {
            'level': 'ERROR',  # Only errors and critical messages
            'class': 'logging.FileHandler',  # Write to a file
            'filename': LOGS_DIR / 'error.log',  # Error log file location
            'formatter': 'verbose',  # Use detailed formatting
        },
        
        # Send all messages to a general log file ğŸ“„
        'file_general': {
            'level': 'INFO',  # Info, warning, error, and critical messages
            'class': 'logging.handlers.RotatingFileHandler',  # Rotating file handler
            'filename': LOGS_DIR / 'django.log',  # General log file location
            'maxBytes': 1024*1024*10,  # 10 MB max file size
            'backupCount': 5,  # Keep 5 backup files
            'formatter': 'verbose',  # Use detailed formatting
        },
        
        # Send messages to console/terminal ğŸ’»
        'console': {
            'level': 'DEBUG',  # All message levels
            'class': 'logging.StreamHandler',  # Print to console
            'formatter': 'simple',  # Use simple formatting
        },
    },
    
    # Root logger configuration ğŸŒ³
    'root': {
        'level': 'INFO',  # Log info level and above
        'handlers': ['console', 'file_general'],  # Send to console and file
    },
    
    # Specific loggers for different parts of Django ğŸ¯
    'loggers': {
        # Django framework messages ğŸ—ï¸
        'django': {
            'handlers': ['console', 'file_general', 'file_error'],
            'level': 'INFO',
            'propagate': False,  # Don't pass to parent loggers
        },
        
        # Django request processing ğŸŒ
        'django.request': {
            'handlers': ['file_error'],  # Log request errors to file
            'level': 'ERROR',
            'propagate': False,
        },
        
        # Your custom app logging ğŸ—ï¸
        'main_app': {
            'handlers': ['console', 'file_general'],
            'level': 'DEBUG',
            'propagate': False,
        },
    },
}

# Development-specific settings ğŸ› ï¸
if DEBUG:
    # In development, also log SQL queries for debugging ğŸ”
    LOGGING['loggers']['django.db.backends'] = {
        'level': 'DEBUG',
        'handlers': ['console'],
        'propagate': False,
    }

# Email configuration (for error notifications) ğŸ“§
# Configure this to receive email notifications for serious errors
EMAIL_BACKEND = 'django.core.mail.backends.console.EmailBackend'  # Print emails to console
# For production, use SMTP:
# EMAIL_BACKEND = 'django.core.mail.backends.smtp.EmailBackend'
# EMAIL_HOST = 'smtp.gmail.com'
# EMAIL_PORT = 587
# EMAIL_USE_TLS = True
# EMAIL_HOST_USER = 'your-email@gmail.com'
# EMAIL_HOST_PASSWORD = 'your-password'

# Admin notification settings ğŸ‘‘
# Django will email these addresses when there's a serious error
ADMINS = [
    # ('Your Name', 'your-email@example.com'),
]

# Manager notification settings ğŸ‘¥
# Managers get email about broken links
MANAGERS = ADMINS

# Security settings (additional) ğŸ›¡ï¸
if not DEBUG:
    # Production security settings
    SECURE_BROWSER_XSS_FILTER = True  # Enable XSS filter
    SECURE_CONTENT_TYPE_NOSNIFF = True  # Prevent MIME sniffing
    X_FRAME_OPTIONS = 'DENY'  # Prevent clickjacking
    SECURE_HSTS_SECONDS = 31536000  # HTTP Strict Transport Security
    SECURE_HSTS_INCLUDE_SUBDOMAINS = True
    SECURE_HSTS_PRELOAD = True

# Cache configuration ğŸš€
# Caching makes your website faster by storing frequently used data
CACHES = {
    'default': {
        # Use local memory cache for development ğŸ’¾
        'BACKEND': 'django.core.cache.backends.locmem.LocMemCache',
        'LOCATION': 'unique-snowflake',
    }
}

# Session configuration ğŸª
# How Django handles user sessions (login status, shopping cart, etc.)
SESSION_ENGINE = 'django.contrib.sessions.backends.db'  # Store sessions in database
SESSION_COOKIE_AGE = 86400  # Session expires after 1 day (86400 seconds)
SESSION_SAVE_EVERY_REQUEST = True  # Update session on every request

print("ğŸš€ Django settings loaded successfully!")
print(f"ğŸ“ Project directory: {BASE_DIR}")
print(f"ğŸ“ Logs directory: {LOGS_DIR}")
print(f"ğŸ”§ Debug mode: {DEBUG}")
print("âœ… All systems ready to go!")
